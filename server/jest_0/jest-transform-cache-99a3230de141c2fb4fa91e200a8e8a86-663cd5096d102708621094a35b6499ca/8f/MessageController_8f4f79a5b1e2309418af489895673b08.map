{"version":3,"sources":["MessageController.js"],"names":["tbl_messages","require","tbl_users","getCatch","module","exports","sendMenssage","req","res","content","fk_id_user","fk_id_chat","body","message","create","catch","err","json","getMessages","id_chat","params","id","messages","findAll","where","username","finOne","id_users","then","user","deleteMessage","id_message","response","destroy"],"mappings":"AAAA,MAAMA,YAAY,GAAGC,OAAO,CAAC,wBAAD,CAA5B;;AACA,MAAMC,SAAS,GAAGD,OAAO,CAAC,qBAAD,CAAzB;;AACA,MAAME,QAAQ,GAAGF,OAAO,CAAC,mBAAD,CAAxB;;AAEAG,MAAM,CAACC,OAAP,GAAiB;AACbC,EAAAA,YAAY,EAAE,OAAMC,GAAN,EAAWC,GAAX,KAAmB;AAC7B,UAAM;AAACC,MAAAA,OAAD;AAAUC,MAAAA,UAAV;AAAsBC,MAAAA;AAAtB,QAAoCJ,GAAG,CAACK,IAA9C;AACA,UAAMC,OAAO,GAAG,MAAMb,YAAY,CAACc,MAAb,CAAoB;AAACL,MAAAA,OAAD;AAAUE,MAAAA,UAAV;AAAsBD,MAAAA;AAAtB,KAApB,EACrBK,KADqB,CACfC,GAAG,IAAIb,QAAQ,CAACa,GAAD,CADA,CAAtB;AAEA,WAAOR,GAAG,CAACS,IAAJ,CAASJ,OAAT,CAAP;AACH,GANY;AAObK,EAAAA,WAAW,EAAE,OAAMX,GAAN,EAAWC,GAAX,KAAmB;AAC5B,UAAMW,OAAO,GAAGZ,GAAG,CAACa,MAAJ,CAAWC,EAA3B;AACA,UAAMC,QAAQ,GAAG,MAAMtB,YAAY,CAACuB,OAAb,CAAqB;AAACC,MAAAA,KAAK,EAAC;AAACb,QAAAA,UAAU,EAAEQ;AAAb;AAAP,KAArB,EACtBJ,KADsB,CAChBC,GAAG,IAAIb,QAAQ,CAACa,GAAD,CADC,CAAvB;;AAEA,SAAIH,OAAJ,IAAeS,QAAf,EAAyB;AACrBT,MAAAA,OAAO,CAACY,QAAR,GAAmB,MAAMvB,SAAS,CAACwB,MAAV,CAAiB;AAACF,QAAAA,KAAK,EAAE;AAACG,UAAAA,QAAQ,EAAEd,OAAO,CAACH;AAAnB;AAAR,OAAjB,EACpBkB,IADoB,CACfC,IAAI,IAAIA,IAAI,CAACJ,QADE,EAEpBV,KAFoB,CAEdC,GAAG,IAAIb,QAAQ,CAACa,GAAD,CAFD,CAAzB;AAGH;;AACD,WAAOR,GAAG,CAACS,IAAJ,CAASK,QAAT,CAAP;AACH,GAjBY;AAkBbQ,EAAAA,aAAa,EAAE,OAAMvB,GAAN,EAAWC,GAAX,KAAmB;AAC9B,UAAMuB,UAAU,GAAGxB,GAAG,CAACa,MAAJ,CAAWC,EAA9B;AACA,UAAMW,QAAQ,GAAG,MAAMhC,YAAY,CAACiC,OAAb,CAAqB;AAACT,MAAAA,KAAK,EAAC;AAACO,QAAAA;AAAD;AAAP,KAArB,EAClBhB,KADkB,CACZC,GAAG,IAAIb,QAAQ,CAACa,GAAD,CADH,CAAvB;AAEA,WAAOR,GAAG,CAACS,IAAJ,CAASe,QAAT,CAAP;AACH;AAvBY,CAAjB","sourcesContent":["const tbl_messages = require('../models/tbl_messages')\r\nconst tbl_users = require('../models/tbl_users')\r\nconst getCatch = require('../utils/getCatch')\r\n\r\nmodule.exports = {\r\n    sendMenssage: async(req, res) => {\r\n        const {content, fk_id_user, fk_id_chat} = req.body\r\n        const message = await tbl_messages.create({content, fk_id_chat, fk_id_user})\r\n        .catch(err => getCatch(err))\r\n        return res.json(message)\r\n    },\r\n    getMessages: async(req, res) => {\r\n        const id_chat = req.params.id\r\n        const messages = await tbl_messages.findAll({where:{fk_id_chat: id_chat}})\r\n        .catch(err => getCatch(err))\r\n        for(message of messages) {\r\n            message.username = await tbl_users.finOne({where: {id_users: message.fk_id_user}})\r\n                .then(user => user.username)\r\n                .catch(err => getCatch(err))\r\n        }\r\n        return res.json(messages)\r\n    },\r\n    deleteMessage: async(req, res) => {\r\n        const id_message = req.params.id\r\n        const response = await tbl_messages.destroy({where:{id_message}})\r\n            .catch(err => getCatch(err))\r\n        return res.json(response)\r\n    },\r\n}"]}